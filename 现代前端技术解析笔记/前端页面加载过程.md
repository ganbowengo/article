<!--
 * @Descripttion: 
 * @Author: ganbowen
 * @Date: 2019-11-26 20:36:36
 * @LastEditors: ganbowen
 * @LastEditTime: 2019-11-27 22:02:49
 -->

#### 1.过程概述
1. dns解析域名获得IP
2. 浏览器根据IP与服务器建立TCP连接
3. 浏览器发起HTTP请求
4. 服务器处理请求并返回HTTP报文
5. 浏览器解析渲染页面
6. 浏览器与服务器断开连接
#### 2.dns解析域名获得IP  
> 1. 域名解析的过程是逐级查询的 
> 2. 查看dns解析记录 dig math.stackexchange.com
> 3. dns优化 
dns解析域名的过程如下
1. 浏览器缓存
2. 操作系统缓存
3. host文件中查找
4. 由器缓存
5. ISP DNS缓存 互联网服务提供商（阿里 百度之类）
6. 顶级DNS服务器/根DNS服务器
#### 3.TCP连接 Browser Service
1. 三次握手与四次挥手
![image](https://raw.githubusercontent.com/ganbowengo/imgs/master/articleImg/440ee50de56edc27c6b3c992b3a25844.png)
> - 三次握手
> 1. Browser ——> Service Browser发送SYN包SYN=1，初始序号seq=x 进入SYN-SENT状态 等待Service确认
> 2. Service ——> Browser Service发送确认报文段中SYN=1，ACK=1，确认号ack=x+1，初始序号seq=y 进入SYN-RECEIVED状态 
> 3. Browser ——> Service Browser发送确认报文段ACK=1，确认号ack=y+1，序号seq=x+1 进入ESTABLISHED状态 等待Service收到包之后 状态切换为ESTABLISHED
> - 四次握手
> 1. Browser ——> Service Browser发出连接释放报文段（FIN=1，序号seq=u）停止再发送数据  主动关闭TCP连接，进入FIN_WAIT1（终止等待1）状态，等待服务端的确认   `B:我要走了`
> 2. Service ——> Browser 服务端收到 FIN 之后 Service发出确认报文段（ACK=1，确认号ack=u+1，序号seq=v）服务端进入CLOSE_WAIT（关闭等待）状态 客户端收到服务端的确认后，进入FIN_WAIT2（终止等待2）状态  `S:我知道了`
> 3. Service ——> Browser Service发出连接释放报文段（FIN=1，ACK=1，序号seq=w，确认号ack=u+1），服务端进入LAST_ACK（最后确认）状态 `S:我也要走了`
> 4. Browser ——> Service Browser发出确认报文段（ACK=1，seq=u+1，ack=w+1），客户端进入TIME_WAIT（时间等待）状态此时TCP未释放掉，服务端进入LAST_ACK，需要经过时间等待计时器设置的时间2MSL后，客户端才进入CLOSED状态。`B:知道了，再见`

参考文章
1. [从输入url到页面展现发生了什么？](https://segmentfault.com/a/1190000013522717)
2. [TCP/IP 是如何工作的](https://time.geekbang.org/column/article/113550)
3. [DNS解析、三次握手与四次挥手](https://zhuanlan.zhihu.com/p/23155051)
4. [TCP与TCP连接详解](https://zhuanlan.zhihu.com/p/53374516)
5. [三次握手与四次挥手](https://juejin.im/post/5d9c284b518825095879e7a5)
