<!--
 * @Descripttion:
 * @Author: ganbowen
 * @Date: 2020-01-16 15:10:02
 * @LastEditors  : ganbowen
 * @LastEditTime : 2020-01-16 16:05:22
 -->

##### 代理模式

利用一个对象 A 作为另一个对象 B 的中间层，通过访问对象 A 去间接访问 B，在 A 对象的间接操作中可以对访问 B 的需求做一层拦截处理。

保护代理 - A 对象过滤对 B 对象不必要的操作

实例 - 过滤垃圾电话：

```
let PhoneOS = {
    getPhone: function(num) {
        if(num !== '不是垃圾电话'){
            PhoneHardware.bell()
        } else{
            this.setBlackList(num)
        }
    },
    setBlackList: function() {
        console.log('设置黑名单')
    }
}

let PhoneHardware = {
    bell(){
        console.log('来电话，响铃')
    }
}

PhoneOS.get('123456789')
```

虚拟代理 - 使用虚拟的 A 代理 B，当 B 准备完成，则将 B 代替 A

实例 - 图片预加载：

```
function loading(imgNode, targetUrl) {
    imgNode.src = '../loading.png'
    let img = new Image()
    img.onload = function() {
        imgNode.src = img.src
    }
    img.src = targetUrl
}

// 将图片预加载 和 操作DOM的src分开
class PreLoadImage{
    constuctor(imgNode) {
        this.imgNode = imgNode
    }
    setUrl(url) {
        this.imgNode.src = url
    }
}

class LoadingImage {
    constuctor(dom) {
        this.preLoadImage = new PreLoadImage(dom)
        this.newImage()
    }
    newImage() {
        this.img = new Image()
        this.img.onload = () => {
            this.preLoadImage.setUrl(img.src)
        }
    }
    setUrl(src) {
        this.preLoadImage.setUrl('../loading.png')
        this.img = src
    }
}
let image = new LoadingImage(docuemnt.getElementById('img'))
image.setUrl('https://www.****.com/png/img.png')
```

缓存代理 - 通过 A 对象调用 B 对象，并将 B 对象的返回结果保存在 A 对象中，如果再次调用 B 对象的相同操作，直接在 A 对象缓存中获取

实例 - 累加：

```
let count = function() {
    console.log('new count')
    return Array.prototype.reduce.call(arguments, function(start, current){
        return start + current
    })
}

let proxyCount = (function() {
    let cache = {}
    return function () {
        let arrString = Array.prototype.join.call(arguments, ',')
        if(arrString in cache) {
            return cache[arrString]
        }
        return cache[arrString] = count(...arguments)
    }
})()

```
